<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">
<link rel="import" href="../paper-date-picker/paper-date-picker.html">
<link rel="import" href="../paper-button/paper-button.html">

<script src="../moment/min/moment-with-locales.min.js"></script>

<!--
This element bind a [date-picker](https://github.com/bendavis78/paper-date-picker) to a paper-input through a paper-dialog.

Example:

    <input-date-picker></input-date-picker>

@group Seed Elements
@element input-date-picker
@demo demo/index.html
@hero hero.svg
-->
<dom-module id="input-date-picker">
  <template>

    <style>

      :host {
        display: block;
      }

    </style>

    <paper-input 
      readonly
      on-tap="_openDatePicker" 
      label="[[label]]"
      value="[[dateFormat(date, format)]]">
    </paper-input>
  
    <paper-dialog id="datePickerDialog" modal class="paper-date-picker-dialog">
      <paper-date-picker 
        id="datePicker" 
        locale="[[locale]]" 
        minYear="[[minYear]]"
        maxYear="[[maxYear]]"
        responsiveWidth="[[responsiveWidth]]"
        date="[[date]]">
      </paper-date-picker>
      <div class="buttons">
        <paper-button dialog-dismiss>Cancel</paper-button>
        <paper-button dialog-confirm aufo-focus on-tap="_closeDatePicker">OK</paper-button>
      </div>
    </paper-dialog>
  
  </template>
</dom-module>

<script>

  Polymer({

    is: 'input-date-picker',


    properties: {

      /**
       * The selected date (YYYY-MM-DD)
       * @attribute date
       * @type Date
       * @default today's date
       */
      date: {
        type: Date,
        notify: true
      },

      /**
       * The input's value date format, cf. [momentjs](http://momentjs.com/)
       * @attribute format
       * @type String
       * @default 'LL'
       */
      format: {
        type: String,
        value: 'LL'
      },

      /**
       * Maximum screen width at which the picker uses a vertical layout
       * @attribute responsiveWidth
       * @type string
       * @default '560px'
       */
      responsiveWidth: {
        type: String,
        value: '560px'
      },

      /**
       * The current locale
       * @attribute locale
       * @type string
       * @default 'en'
       */
      locale: {
        type: String,
        value: 'en'
      },

      /*
       * The minumum allowable year
       * @attribute minYear
       * @type int
       * @default 1900
       */
      minYear: {
        type: Number,
        value: 1900
      },

      /*
       * The maximum allowable year
       * @attribute maxYear
       * @type int
       * @default 2100
       */
      maxYear: {
        type: Number,
        value: 2100
      },

      /**
       * The label for the paper-input.
       */
      label: {
        type: String,
        value: 'Date'
      },

    },

    dateFormat: function(date, format) {
      if (!date) {
        return '';
      }
      return moment(date).format(format);
    },

    _openDatePicker: function() {
      this.$.datePickerDialog.open();
    },

    _closeDatePicker: function() {
      this.date = this.$.datePicker.date;
    }

  });

</script>
